#!/usr/bin/env node
/*! For license information please see ipynb2web.cli.min.cjs.LICENSE.txt */
(()=>{"use strict";var e={3:e=>{e.exports=require("path")},216:(e,t,n)=>{n.r(t),n.d(t,{convertNb:()=>A,get_metadata:()=>j,nb2json:()=>w});const r=require("marked");function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){return"<details "+(t?"open":"")+"> <summary>Click to toggle</summary> "+e+"</details>"}function c(e){return(e=(e=(e=(e=(e=e.replaceAll("ðŸ™‚","&#1F642")).replaceAll("ðŸ˜³","&#128563")).replaceAll("â€ƒ","&#8195")).replaceAll("ðŸ‘·","&#128119")).replaceAll("ðŸ§¡","&#129505")).replaceAll("ðŸ’–","&#128150")}function s(e){return function(e){var t=[];e=e.replace(/<pre[\s\S]*?<\/pre>|<code[\s\S]*?<\/code>/g,function(e){return"__CODE_".concat(t.push(e)-1,"__")});return(e=e.replace(/\[([^\]]*?)\]\s*\{\s*([^}]*)\}/g,function(e,t,n){return"<span".concat(function(e){var t=e.match(/#([A-Za-z0-9_-]+)/),n=o(e.matchAll(/\.([A-Za-z0-9_-]+)/g)).map(function(e){return e[1]});return"".concat(t?' id="'.concat(t[1],'"'):"").concat(n.length?' class="'.concat(n.join(" "),'"'):"")}(n),">").concat(t,"</span>")})).replace(/__CODE_(\d+)__/g,function(e,n){return t[n]})}(e=function(e){var t=0;return e.replace(/\^\[([\s\S]+?)\]/g,function(e,n){console.log("Inline note:",n),t++;var r='<label tabindex="0" for="note'.concat(t,'" class="notelbl">[').concat(t,"]</label>");return'<span class="note">\n      <input type="checkbox" id="note'.concat(t,'" class="notebox">\n      ').concat(r,'\n      <aside class="inline-note"> \n        ').concat(r,"\n        ").concat(n,"\n      </aside>\n    </span>")})}(e=function(e){var t=[];e=e.replace(/<pre[\s\S]*?<\/pre>|<code[\s\S]*?<\/code>/g,function(e){return"__CODE_".concat(t.push(e)-1,"__")});for(var n=function(e,t){return"<div".concat(r(e),">").concat(t.trim(),"</div>")},r=function(e){var t=e.match(/#([A-Za-z0-9_-]+)/),n=o(e.matchAll(/\.([A-Za-z0-9_-]+)/g)).map(function(e){return e[1]});return"".concat(t?' id="'.concat(t[1],'"'):"").concat(n.length?' class="'.concat(n.join(" "),'"'):"")},a=6;a>0;a--){var i=":".repeat(a),c=new RegExp("".concat(i,"\\s*{\\s*([^}]*)}\\s*([\\s\\S]*?)\\s*").concat(i),"g");e=e.replace(c,function(e,t,r){return n(t,r.trim())})}return e.replace(/__CODE_(\d+)__/g,function(e,n){return t[n]})}(e)))}function l(e,t,n){return e.replace(t,function(e,t){var r;return(null===(r=n.replace)||void 0===r?void 0:r.call(n,"$1",t))||n(e,t)})}function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return p(l,"_invoke",function(n,r,o){var a,c,s,l=0,u=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,s=e,f.n=n,i}};function d(n,r){for(c=n,s=r,t=0;!p&&l&&!o&&t<u.length;t++){var o,a=u[t],d=f.p,v=a[2];n>3?(o=v===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,f.v=r,f.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,c=0))}if(o||n>1)return i;throw p=!0,r}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&d(u,v),c=u,s=v;(t=c<2?e:s)||!p;){a||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(l=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==i)break}catch(t){a=e,c=1,s=t}finally{l=1}}return{value:t,done:p}}}(n,o,a),!0),l}var i={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(p(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,p(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,p(d,"constructor",l),p(l,"constructor",s),s.displayName="GeneratorFunction",p(l,o,"GeneratorFunction"),p(d),p(d,o,"Generator"),p(d,r,function(){return this}),p(d,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:v}})()}function p(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}p=function(e,t,n,r){function a(t,n){p(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},p(e,t,n,r)}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}var m=!1,y=[],g=[],b=0;function w(e){return _.apply(this,arguments)}function _(){var e;return e=u().m(function e(t){var n,r,o,a,i,s,l,p,f=arguments;return u().w(function(e){for(;;)switch(e.n){case 0:return n=f.length>1&&void 0!==f[1]&&f[1],r=f.length>2&&void 0!==f[2]&&f[2],y=[],m=!1,g=[],b=0,o=t,"undefined"==typeof process||t.startsWith("http")||(o="http://localhost:8085/".concat(t,".ipynb")),e.n=1,fetch(o,{headers:{"Content-Type":"application/json; charset=utf-8"}});case 1:return a=e.v,e.n=2,a.json();case 2:return i=e.v,(s=j(i.cells[0])).filename=t.split("/")[t.split("/").length-1].toLowerCase().replaceAll(" ","_"),n&&console.log("- get_metadata",s,"\n"),l=A(i.cells.slice(1),s,n,r,s.filename).flat().join(" "),n&&y.length&&console.log({pyCode:y}),s.pyCode=y,(s.prettify||m)&&(l+='\n  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"><\/script>\n  <link rel="stylesheet" href="https://cdn.rawgit.com/google/code-prettify/master/styles/desert.css"/>\n  '),p=c(l),n&&console.log("- - replaceEmojis Ran","\n"),e.a(2,{meta:s,content:p,assets:g})}},e)}),_=function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){h(a,r,o,i,c,"next",e)}function c(e){h(a,r,o,i,c,"throw",e)}i(void 0)})},_.apply(this,arguments)}function j(e){var t,n={},r=d(e.source);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.startsWith("#"))n.title=o.replaceAll("\n","").replaceAll("# ","",2);else if(o.startsWith(">"))n.summary=o.replaceAll("\n","").replaceAll("> ","",1);else if(o.startsWith("-")){var a=o.slice(o.indexOf("- ")+2,o.indexOf(": ")),i=o.slice(o.indexOf(": ")+2).replaceAll("\n","").trim();n[a]=i}}}catch(e){r.e(e)}finally{r.f()}return n}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;n&&console.group("- convertNb Running");var c=e.map(function(e){return function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n="markdown"==e.cell_type?function(e){var t=(0,r.marked)(e);return t=l(t=t.replace(/\s{2,}<\/p>/g,"</p><br>"),/<pre><code>([\s\S]*?)<\/code><\/pre>/g,function(e,t){return m=!0,"<pre class='prettyprint'>".concat(t,"</pre>")}),t=s(t=l(t,/<a\s+(?:[^>]*?\s+)?href="(.*?)"/g,function(e,t){return t.startsWith("./")||(e+=' target="_blank" rel="nosopener noreferrer nofollow"'),e}))}(e.source.join(" ")):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=[],c=[];if(e.source.length){var s=e.source;c=function(e){var t=e.split(/\s+/);return["#collapse_input_open","#collapse_input","#collapse_output_open","#collapse_output","#hide_input","#hide_output","#hide","%%capture","%%javascript","%%html","#export"].filter(function(e){return t.includes(e)})}(s[0]),c.length>0&&(s=s.slice(1)),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"#export"==t[t.length-1]&&y.push(e);var o,a=d(t);try{for(a.s();!(o=a.n()).done;){var c=o.value;if(["#hide","#hide_input","%%javascript","%%html","%%capture"].includes(c))return""}}catch(e){a.e(e)}finally{a.f()}if(n.prettify&&(e="<pre class='prettyprint'>".concat(e,"</pre>")),t&&!!t.includes("#collapse_input_open")){r&&console.log(t);var s,l=d(t);try{for(l.s();!(s=l.n()).done;){var u=s.value;e=(e=e.replaceAll(u+"\r\n","")).replaceAll(u+"\n",""),"#collapse_input_open"==u?e=i(e,!0):"#collapse_input"==u&&(e=i(e,!1))}}catch(e){l.e(e)}finally{l.f()}return e}}(s.join(" "),c,t),a.push(s)}if(e.outputs.length){var l,u=d(e.outputs);try{for(u.s();!(l=u.n()).done;){var p=l.value;a.push(O(p,c,n,r,o))}}catch(e){u.e(e)}finally{u.f()}}return a}(e,t,o,a,c),n}(e,t,n,o,a)});return n&&console.groupEnd(),c}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("error"==e.output_type)return"";if("stream"==e.output_type){if("stderr"==e.name)return"";e.data={"text/html":e.text}}var a=Object.keys(e.data);(n||r)&&console.log("processOutput debug:",{keys:a,data:e.data,hasTextHtml:a.includes("text/html"),hasTextPlain:a.includes("text/plain"),hasAppJs:a.includes("application/javascript"),imageKeys:a.filter(function(e){return e.startsWith("image/")})});var c=function(e){var t=!0===r||Array.isArray(r)&&r.some(function(t){return t.toLowerCase()===e||t.toLowerCase()===e.split("/")[1]||"application/javascript"===e&&"js"===t.toLowerCase()||"text/html"===e&&"html"===t.toLowerCase()});return!n&&!r||"text/html"!==e&&"application/javascript"!==e||console.log("shouldExtract debug:",{type:e,extractAssets:r,result:t,isArray:Array.isArray(r)}),t};if(a.includes("text/html")){var s=e.data["text/html"];e=Array.isArray(s)?s.join(""):s;var l=(new TextEncoder).encode(e).length,u=e.toLowerCase().includes("<!doctype"),p=e.toLowerCase().trim().startsWith("<html"),v=l>102400;if(c("text/html")&&"undefined"!=typeof process&&(u||p||v)){var h=e.substring(0,8).replace(/[^a-zA-Z0-9]/g,""),m="".concat(o?"".concat(o,"-"):"","content-").concat(h,".html");(n||r)&&console.log("Extracting HTML asset:",{name:m,dataLength:e.length,sizeInBytes:l,startsWithDoctype:u,startsWithHtml:p,isLargeEnough:v,hash:h}),g.push({placeholderName:m,data:e,encoding:"utf8",type:"text/html",notebookPrefix:o?"".concat(o,"-"):""}),e='<iframe src="ASSET_PLACEHOLDER_'.concat(m,'" width="100%" height="400px"></iframe>')}}else if(a.includes("application/javascript")){var y=e.data["application/javascript"],w=Array.isArray(y)?y.join(""):y,_=(new TextEncoder).encode(w).length,j=_>102400;if(c("application/javascript")&&"undefined"!=typeof process&&j){var A=w.toString().substring(0,8).replace(/[^a-zA-Z0-9]/g,""),O="".concat(o?"".concat(o,"-"):"","script-").concat(A,".js");(n||r)&&console.log("Extracting JS asset:",{name:O,sizeInBytes:_,isLargeEnough:j}),g.push({placeholderName:O,data:w,encoding:"utf8",type:"application/javascript"}),e='<script src="ASSET_PLACEHOLDER_'.concat(O,'"><\/script>')}else e="<script>"+w+"<\/script>"}else{var S=a.filter(function(e){return e.startsWith("image/")})[0];if(S&&e.data[S]){var x=e.data[S];if((n||r)&&console.log("Image processing debug:",{imageKey:S,dataType:f(x),dataLength:null==x?void 0:x.length,shouldExtractResult:c(S),processEnv:"undefined"!=typeof process}),"string"==typeof x&&x.length>50){var k=S.split("/")[1];if(c(S)&&"undefined"!=typeof process){b++;var E=k;"jpeg"===k&&(E="jpg"),"svg+xml"===k&&(E="svg");var P="".concat(o?"".concat(o,"-"):"","image-").concat(b,".").concat(E),T="svg+xml"===k?"utf8":"base64";(n||r)&&console.log("Extracting image asset:",{name:P,imageType:k,extension:E,encoding:T,dataLength:x.length,imageIndex:b}),g.push({placeholderName:P,data:x,encoding:T,type:S,notebookPrefix:o?"".concat(o,"-"):""}),e='<img src="ASSET_PLACEHOLDER_'.concat(P,'" alt="Image Alt Text">')}else(n||r)&&console.log("Image not extracted - inline instead:",{shouldExtract:c(S),processUndefined:"undefined"==typeof process}),e='<img src="data:'.concat(S,";base64,").concat(x,'" alt="Image Alt Text">')}else(n||r)&&console.log("Found image key but invalid data:",{imageKey:S,dataType:f(x),dataLength:null==x?void 0:x.length}),e=""}else if(a.includes("text/plain")){var I=e.data["text/plain"];e=/<Figure/.test(I)?"":Array.isArray(I)?I.join(""):I}else(n||r)&&console.log("No recognized content type found:",{keys:a,availableData:Object.keys(e.data)}),e=""}var C,N=d(t);try{for(N.s();!(C=N.n()).done;){var F=C.value;try{e=(e=e.replaceAll(F+"\r\n","")).replaceAll(F+"\n","")}catch(t){n&&console.log("ERROR: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!processOutput... ",f(e),e)}"#collapse_output_open"==F&&(e=i(e,!0)),"#collapse_output"==F&&(e=i(e,!1)),"#hide_output"==F&&(e=""),"#hide"==F&&(e="")}}catch(e){N.e(e)}finally{N.f()}return e}},233:(e,t,n)=>{n.r(t),n.d(t,{createSpeech:()=>l,getTextFromJson:()=>d,saveSpeech:()=>p,speechFromDir:()=>h});var r=n(383),o=n(3);function a(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return i(u,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function d(n,r){for(i=n,c=r,t=0;!p&&l&&!o&&t<u.length;t++){var o,a=u[t],d=f.p,v=a[2];n>3?(o=v===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,f.v=r,f.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,i=0))}if(o||n>1)return s;throw p=!0,r}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&d(u,v),i=u,c=v;(t=i<2?e:c)||!p;){a||(i?i<3?(i>1&&(f.n=-1),d(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(p=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:p}}}(n,o,a),!0),u}var s={};function l(){}function u(){}function p(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),d=p.prototype=l.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=p,i(d,"constructor",p),i(p,"constructor",u),u.displayName="GeneratorFunction",i(p,o,"GeneratorFunction"),i(d),i(d,o,"Generator"),i(d,r,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:c,m:v}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,r)}function c(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)})}}function l(e,t){return u.apply(this,arguments)}function u(){return u=s(a().m(function e(t,n){var r,o,i,c,s,l,u,p=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=p.length>2&&void 0!==p[2]?p[2]:"echo",o=p.length>3&&void 0!==p[3]?p[3]:1,i=p.length>4&&void 0!==p[4]?p[4]:"tts-1",c=p.length>5&&void 0!==p[5]&&p[5],n||(n=process.env.OPENAI_API_KEY),n){e.n=1;break}return c&&console.log('No API Key provided and "env.OPENAI_API_KEY" not found.'),e.a(2);case 1:return e.p=1,new OpenAI(n),e.n=2,fetch("https://api.openai.com/v1/audio/speech",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({model:i,input:t,voice:r,speed:o,response_format:"mp3"})});case 2:return s=e.v,e.n=3,s.buffer();case 3:l=e.v,e.n=5;break;case 4:return e.p=4,u=e.v,c&&console.log("createSpeech error",u),e.a(2);case 5:return e.a(2,l)}},e,null,[[1,4]])})),u.apply(this,arguments)}function p(e,t){return f.apply(this,arguments)}function f(){return f=s(a().m(function e(t,n){var o,i,c=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=c.length>2&&void 0!==c[2]&&c[2],e.p=1,e.n=2,r.promises.writeFile(t,n);case 2:o&&console.log("Audio saved to ".concat(t)),e.n=4;break;case 3:e.p=3,i=e.v,o&&console.log("saveSpeech error",i);case 4:return e.a(2)}},e,null,[[1,3]])})),f.apply(this,arguments)}function d(e,t){return v.apply(this,arguments)}function v(){return v=s(a().m(function e(t,n){var r,o,i,c,s,l,u=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:"gpt-4o-mini",o=u.length>3&&void 0!==u[3]&&u[3],n||(n=process.env.OPENAI_API_KEY),n){e.n=1;break}return o&&console.log('No API Key provided and "env.OPENAI_API_KEY" not found.'),e.a(2);case 1:return e.p=1,i=t.title?"Title:   ".concat(t.title," \n "):"",i+=t.summary?"Summary: ".concat(t.summary," \n "):"",i+="Content: ".concat(JSON.stringify(t.content)),c={model:r,messages:[{role:"system",content:'\nYou are an assistant to a webpage to audio service. \nYou will be given a webpage you must convert it to a form of text ready for reading aloud.\nStart every conversion with a statement "You are listening to the audio version of this webpage" followed by the title and summary.\nUnder no circumstances should code be read and should be paraphrased or skipped. \n'},{role:"user",content:i}]},e.n=2,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(c)});case 2:return s=e.v,e.n=3,s.json();case 3:e.v.choices[0].message.content,e.n=5;break;case 4:return e.p=4,l=e.v,o&&console.log("getTextFromJson error",l),e.a(2);case 5:return e.a(2,data)}},e,null,[[1,4]])})),v.apply(this,arguments)}function h(e,t,n){return m.apply(this,arguments)}function m(){return m=s(a().m(function e(t,n,i){var c,s,u,f,v,m,y,g,b,w,_,j=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(c=j.length>3&&void 0!==j[3]&&j[3],i||(i=process.env.OPENAI_API_KEY),i){e.n=1;break}return c&&console.log('No API Key provided and "env.OPENAI_API_KEY" not found.'),e.a(2);case 1:e.p=1,s=r.readdirSync(t),u=0;case 2:if(!(u<s.length)){e.n=7;break}if(f=o.join(t,s[u]),!r.lstatSync(f).isDirectory()){e.n=3;break}h(f,n),e.n=6;break;case 3:if(!(f.indexOf(".json")>=0)){e.n=6;break}if(m=r.readFileSync(f,"utf8"),null==(y=JSON.parse(m))||null===(v=y.meta)||void 0===v||!v.audio){e.n=6;break}return e.n=4,d(y);case 4:return g=e.v,e.n=5,l(g,i);case 5:b=e.v,w=s[u].substring(0,s[u].length-5),p(o.join(n,w)+".mp3",b);case 6:u++,e.n=2;break;case 7:e.n=9;break;case 8:return e.p=8,_=e.v,c&&console.log("speechFromDir error",_),e.a(2);case 9:return e.a(2)}},e,null,[[1,8]])})),m.apply(this,arguments)}},383:e=>{e.exports=require("fs")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};n.r(o),n.d(o,{default:()=>T});var a=n(383),i=n(3);const c=require("crypto"),s=require("http-server");var l=["csp","sitemap","breadcrumbs","badges","keywords","comments","hide","image","toc","title"],u=["csp","sitemap","breadcrumbs","badges","keywords","comments","hide","image","toc","title"];function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return h(l,"_invoke",function(n,r,o){var a,c,s,l=0,u=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,s=e,f.n=n,i}};function d(n,r){for(c=n,s=r,t=0;!p&&l&&!o&&t<u.length;t++){var o,a=u[t],d=f.p,v=a[2];n>3?(o=v===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,f.v=r,f.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,c=0))}if(o||n>1)return i;throw p=!0,r}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&d(u,v),c=u,s=v;(t=c<2?e:s)||!p;){a||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(l=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==i)break}catch(t){a=e,c=1,s=t}finally{l=1}}return{value:t,done:p}}}(n,o,a),!0),l}var i={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(h(t={},r,function(){return this}),t),p=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,h(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=l,h(p,"constructor",l),h(l,"constructor",s),s.displayName="GeneratorFunction",h(l,o,"GeneratorFunction"),h(p),h(p,o,"Generator"),h(p,r,function(){return this}),h(p,"toString",function(){return"[object Generator]"}),(v=function(){return{w:a,m:f}})()}function h(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}h=function(e,t,n,r){function a(t,n){h(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},h(e,t,n,r)}function m(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){m(a,r,o,i,c,"next",e)}function c(e){m(a,r,o,i,c,"throw",e)}i(void 0)})}}function g(e){return e&&({"text/html":"html","text/plain":"txt","application/javascript":"js","image/png":"png","image/jpeg":"jpg","image/gif":"gif","image/svg+xml":"svg","image/webp":"webp"}[e]||e.split("/")[1])||"txt"}function b(){return b=y(v().m(function e(){var t,r,o=arguments;return v().w(function(e){for(;;)switch(e.n){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"./src/posts/",r=o.length>1&&void 0!==o[1]?o[1]:"./src/client/audio/",e.n=1,Promise.resolve().then(n.bind(n,233));case 1:(0,e.v.speechFromDir)(t,r);case 2:return e.a(2)}},e)})),b.apply(this,arguments)}function w(){return w=y(v().m(function e(){var t,n,r,o,i,c,s=arguments;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"./",n=s.length>1&&void 0!==s[1]?s[1]:"./sitemap.txt",r=s.length>2&&void 0!==s[2]?s[2]:"",(o=!(s.length>3&&void 0!==s[3])||s[3])&&console.log("\n\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ START createSitemap \n\n"),e.n=1,_(t,"",r,o);case 1:return i=e.v,console.log("pages",i),e.p=2,e.n=3,a.promises.writeFile(n,i.join("\n")+"\n");case 3:o&&console.log("Sitemap file created successfully:",n),e.n=5;break;case 4:e.p=4,c=e.v,o&&console.error("Error creating or truncating sitemap file: ".concat(n),c);case 5:return e.a(2)}},e,null,[[2,4]])})),w.apply(this,arguments)}function _(e){return j.apply(this,arguments)}function j(){return j=y(v().m(function e(t){var n,r,o,c,s,l,u,p,d,h,m=arguments;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=m.length>1&&void 0!==m[1]?m[1]:"",r=m.length>2&&void 0!==m[2]?m[2]:"",o=m.length>3&&void 0!==m[3]&&m[3],c=[],!["node_modules",".git","venv","env","__pycache__","dist","build",".idea",".vscode",".DS_Store",".pytest_cache",".mypy_cache","venv3","venv2","docs"].some(function(e){return t.includes(e)})){e.n=1;break}return e.a(2,c);case 1:return e.n=2,a.promises.stat(t);case 2:if(e.v.isDirectory()){e.n=3;break}return e.a(2,c);case 3:return console.log("prossdir",{directory:t}),e.n=4,a.promises.readdir(t);case 4:return s=e.v,e.n=5,Promise.all(s.filter(function(e){return e.includes("_map.json")}).map(function(){var e=y(v().m(function e(o){var s,l;return v().w(function(e){for(;;)switch(e.n){case 0:return s=i.join(t,o),l=JSON,e.n=1,a.promises.readFile(s,"utf-8");case 1:l.parse.call(l,e.v).forEach(function(e){if(e.filename){var t="/".concat(o.split("_")[0].split(".")[0],"/").concat(n?n+"/":"").concat(e.filename);c.push(r?r+t:t)}});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 5:l=f(s.filter(function(e){return!i.extname(e)})),e.p=6,l.s();case 7:if((u=l.n()).done){e.n=10;break}return p=u.value,e.n=8,_(i.join(t,p),"",r,o);case 8:d=e.v,c=c.concat(d);case 9:e.n=7;break;case 10:e.n=12;break;case 11:e.p=11,h=e.v,l.e(h);case 12:return e.p=12,l.f(),e.f(12);case 13:return e.a(2,c)}},e,null,[[6,11,12,13]])})),j.apply(this,arguments)}function A(){return A=y(v().m(function e(t,n,r){var o,c,s=arguments;return v().w(function(e){for(;;)switch(e.n){case 0:return c=s.length>4&&void 0!==s[4]?s[4]:null,t||(t="./"),r||(r="./"),(o=s.length>3&&void 0!==s[3]&&s[3])&&console.log("\n~ ~ ~ cli_nbs2html: ".concat(t).concat(n,"\n")),e.n=1,a.promises.stat("".concat(t).concat(n,"/"));case 1:if(e.v.isDirectory()){e.n=2;break}return o&&console.log("\n\n UNABLE TO PROCESS DIRECTORY: ",n),e.a(2);case 2:return e.n=3,a.promises.readdir("".concat(t).concat(n,"/"));case 3:O(e.v.filter(function(e){return".ipynb"===i.extname(e)}).map(function(e){return i.parse(e).name}),t,n,r,o,c);case 4:return e.a(2)}},e)})),A.apply(this,arguments)}function O(e,t,n,r){return S.apply(this,arguments)}function S(){return S=y(v().m(function e(t,n,o,c){var d,h,m,y,g,b,w,_,j,A,O,S,k,E,P,T,I,C,N,F=arguments;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return h=F.length>5&&void 0!==F[5]?F[5]:null,(d=F.length>4&&void 0!==F[4]&&F[4])&&console.log("\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ cli_nbs2html: generate_sectionmap: ",t,o,d=!1),(m=s.createServer({root:"./",cors:!0,host:"0.0.0.0"})).listen(8085,function(){}),y=[],e.p=1,e.n=2,a.promises.access("".concat(c).concat(o));case 2:e.n=9;break;case 3:if(e.p=3,"ENOENT"!==(P=e.v).code){e.n=8;break}return e.p=4,e.n=5,a.promises.mkdir("".concat(c).concat(o),{recursive:!0});case 5:e.n=7;break;case 6:e.p=6,T=e.v,console.error("Error creating directory:",T);case 7:e.n=9;break;case 8:console.error("Error accessing directory:",P);case 9:if(!h){e.n=13;break}return e.p=10,g=i.isAbsolute(h)?h:i.join(c,h),e.n=11,a.promises.mkdir(g,{recursive:!0});case 11:d&&console.log("Assets directory ready: ".concat(g)),e.n=13;break;case 12:e.p=12,I=e.v,d&&console.warn("Warning: Could not ensure assets directory exists:",I.message);case 13:if(!o){e.n=15;break}return e.n=14,x("".concat(n).concat(o),c,"json",h);case 14:(b=e.v.meta).csp,b.sitemap,b.breadcrumbs,b.badges,b.keywords,b.comments,b.hide,b.image,b.toc,b.title,w=p(b,l),y.push(w);case 15:_=f(t),e.p=16,_.s();case 17:if((j=_.n()).done){e.n=21;break}if(A=j.value,!(C=!A.startsWith("_"))){e.n=19;break}return e.n=18,x("".concat(n).concat(o,"/").concat(A),"".concat(c).concat(o),"json",h);case 18:C=e.v;case 19:(O=C)&&!O.meta.hide&&((S=O.meta).csp,S.sitemap,S.breadcrumbs,S.badges,S.keywords,S.comments,S.hide,S.image,S.toc,S.title,k=p(S,u),y.push(k));case 20:e.n=17;break;case 21:e.n=23;break;case 22:e.p=22,N=e.v,_.e(N);case 23:return e.p=23,_.f(),e.f(23);case 24:return E="".concat(c).concat(o||"index","_map.json"),e.p=25,e.n=26,a.promises.writeFile(E,JSON.stringify(y));case 26:e.n=29;break;case 27:return e.p=27,e.v,e.n=28,a.promises.writeFile(E,"{}");case 28:d&&console.log("----ERROR:",r.meta);case 29:m.close(function(){d&&console.log("Server closed.")});case 30:return e.a(2)}},e,null,[[25,27],[16,22,23,24],[10,12],[4,6],[1,3]])})),S.apply(this,arguments)}function x(e,t){return k.apply(this,arguments)}function k(){return k=y(v().m(function e(t,r){var o,s,l,u,p,d,h,m,y,b,w,_,j,A,O,S,x,k,E,P,T,I,C=arguments;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=C.length>3&&void 0!==C[3]?C[3]:null,"json"!==(o=C.length>2&&void 0!==C[2]?C[2]:"json")){e.n=3;break}return e.n=1,Promise.resolve().then(n.bind(n,216));case 1:return u=e.v,p=u.nb2json,e.n=2,p(t,!1,!!s&&["svg","png","jpeg","webp","gif","html","js"]);case 2:l=e.v;case 3:if(!(l.assets&&l.assets.length>0&&s)){e.n=17;break}return e.p=4,e.n=5,a.promises.mkdir(s,{recursive:!0});case 5:d=f(l.assets),e.p=6,d.s();case 7:if((h=d.n()).done){e.n=12;break}if(y=h.value,b=Array.isArray(y.data)?y.data.join(""):y.data,w=c.createHash("md5").update(b).digest("hex").substring(0,8),_=y.placeholderName.includes(".")?y.placeholderName:"".concat(y.notebookPrefix||"").concat((null===(m=y.type)||void 0===m?void 0:m.split("/")[0])||"content","-").concat(w,".").concat(g(y.type)),j=i.join(s,_),A=Array.isArray(y.data)?y.data.join(""):y.data,"base64"!==y.encoding){e.n=9;break}return A=Buffer.from(A,"base64"),e.n=8,a.promises.writeFile(j,A);case 8:e.n=10;break;case 9:return e.n=10,a.promises.writeFile(j,A,y.encoding);case 10:console.log("Asset saved: ".concat(j)),O="".concat(s,"/").concat(_).replace(/^\.\//,""),l.content=l.content.replace("ASSET_PLACEHOLDER_".concat(y.placeholderName),O);case 11:e.n=7;break;case 12:e.n=14;break;case 13:e.p=13,T=e.v,d.e(T);case 14:return e.p=14,d.f(),e.f(14);case 15:e.n=17;break;case 16:e.p=16,I=e.v,console.error("Error saving assets:",I);case 17:if(delete l.assets,null==(S=l.meta.pyCode)||!S.length){e.n=18;break}return x=(x=i.basename(t,".ipynb")).replace(/^\d{2}_/,""),x=l.meta.default_exp||x,k=i.join(r,"".concat(x,".py")),E=S.join("\n").replace(/(^|\n) /g,"$1"),e.n=18,a.promises.writeFile(k,E);case 18:return delete l.meta.pyCode,P=i.join(r,"".concat(l.meta.filename,".").concat(o)),e.p=19,e.n=20,a.promises.writeFile(P,"json"===o?JSON.stringify(l):l);case 20:e.n=22;break;case 21:e.p=21,e.v,console.log("ERROR writing file:",P);case 22:return e.a(2,l)}},e,null,[[19,21],[6,13,14,15],[4,16]])})),k.apply(this,arguments)}function E(e){var t=e[0]||"",n=e[1]||!1,r=e[2]||!1,o=e[2]||!1,a=e[3]||"",i=e[4]||null;console.log("CLI RECEIVED ARGS:"),"sitemap"===t?function(){w.apply(this,arguments)}(n||"./",o||"./sitemap.txt",a):"audio"===t?function(){b.apply(this,arguments)}(r,n):function(e,t,n){A.apply(this,arguments)}(r,t,n,!0,i)}if("file:///home/carlos/Documents/GitHub/ipynb2web/src/cli.js".includes("ipynb2web")){var P=process.argv.slice(2);"help"===P[0]||0===P.length?console.log("Usage: ipynb2web <COMMAND> <SAVETO> <FROM/or/SitemapName> [PathPrefix]\n    \nCommands:\n  sitemap      Create a sitemap.\n  audio        Create audio assets.\n  help         Display this help message.\n\nFor sitemap command:\n  PathPrefix   Optional prefix to add to all URLs (e.g., '/docs')\n               Example: ipynb2web sitemap ./ ./sitemap.txt /docs\n\nFor processing notebooks (non-sitemap, non-audio commands):\n  AssetsDir    Optional directory path for saving static assets separately\n               instead of inlining them. When provided, images and other \n               assets will be saved as separate files in this directory.\n               Example: ipynb2web notebooks ./output ./input '' ./assets\n               \nExamples:\n  ipynb2web help\n  ipynb2web sitemap ./ ./sitemap.txt /docs\n  ipynb2web audio ./input ./output\n  ipynb2web notebooks ./output ./input\n  ipynb2web notebooks ./output ./input '' ./static-assets\n"):E(P)}const T=E;module.exports=o})();